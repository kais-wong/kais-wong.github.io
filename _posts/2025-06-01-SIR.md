---
title: "SIR Model for Epidemiology (SARS-CoV-2)"
date: 2025-06-01T15:34:30-04:00
categories:
  - projects
header:
  teaser: /assets/images/sir/seir_epidemic_progression_forward_euler.gif
tags:
  - SIR
  - Epidemiology
  - Python
toc: true
toc_label: "Table of Contents"
toc_icon: "cog"
---
Simple compartmental model for epidemiological motion. Epidemic Trajectory of SARS-CoV-2 in Wuhan.

<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script type="text/javascript" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

## Background
One of the most basic models to study the spread of infectious diseases is known as “SIR". This is a system of ODEs for the number of susceptible (S), infected (I), and recovered (R) individuals in a population. It can be expressed by the system of ODEs below.

$$
\begin{aligned}
\frac{dS}{dt} &= -\frac{\beta}{N}IS, \\\\
\frac{dI}{dt} &= \frac{\beta}{N}IS - \gamma I, \\\\
\frac{dR}{dt} &= \gamma I,
\end{aligned}
$$

where:

- \( S \) is the stock of **susceptible** individuals (in units: number of people),
- \( I \) is the stock of **infected** individuals (in units: number of people),
- \( R \) is the stock of **removed** individuals — those who have either recovered or died (in units: number of people),
- \( N = S + I + R \) is the **total population** (in units: number of people),
- \( \beta \) is the **infection rate constant** (units: number of people infected per day per infected person),
- \( \gamma \) is the **recovery rate constant** (units: fraction of a person recovered per day per infected person),

with time measured in **days**.

## SIR

A simple SIR model for epidemiological movement can be constructed with a constant beta. Given the parameters: $[S(0), I(0), R(0)] = [995, 5, 0]$ and $\beta = 1, \gamma = 1/3$.

```python
# beta and gamma are global variables
def forward_euler(S, I, R, dt_daily):
    """Evaluate population model using forward euler simulation"""
    for i in range(S.shape[0] - 1):
        # Calculate the derivatives for the current time step i
        dS = -(beta * I[i] * S[i] / N)
        dI = (beta * I[i] * S[i] / N) - (gamma * I[i])
        dR = (gamma * I[i])

        # Update the population sizes for the next time step i + 1
        S[i + 1] = S[i] + dt_daily * dS
        I[i + 1] = I[i] + dt_daily * dI
        R[i + 1] = R[i] + dt_daily * dR
    return S, I, R
```

If modeled for 60 days we arrive at the figure below.

{% include figure popup=true image_path="/assets/images/sir/SIR_60.png" alt="SIR" caption="Figure 1: SIR Epidemic Trajectory using Forward Euler" %}

## SEIR

It can be shown that in the SIR model, I will eventually go to zero, i.e., the infection disappears from the population. Many infectious diseases however remain endemic in the population. This is modeled by adding so-called vital effects (births and deaths) to the basic SIR model. A further enhancement is to add an incubation period during which individuals who have been exposed and infected are not yet infectious themselves. This is done through an extra variable E of the number of exposed individuals. It is governed by the equations:

$$
\begin{aligned}
\frac{dS}{dt} &= -\frac{\beta}{N}IS + \mu N - \mu S, 
\quad &\text{// S: susceptible individuals} \\\\
\frac{dE}{dt} &= \frac{\beta}{N}IS - \epsilon E - \mu E, 
\quad &\text{// E: exposed (infected but not yet infectious)} \\\\
\frac{dI}{dt} &= \epsilon E - \gamma I - \mu I, 
\quad &\text{// I: infectious individuals} \\\\
\frac{dR}{dt} &= \gamma I - \mu R, 
\quad &\text{// R: removed (recovered or deceased individuals)}
\end{aligned}
$$

where:

- \( N = S + E + I + R \): Total population
- \( \beta \): Infection rate (people infected per day per infectious person)
- \( \epsilon \): Incubation rate (rate at which exposed individuals become infectious)
- \( \gamma \): Recovery rate (rate at which infectious individuals recover)
- \( \mu \): Natural birth/death rate (rate of entering/leaving population)
- Time is measured in days

Let the initial population $N$ be 1000, and $[S(0), E(0), I(0), R(0)] = [900, 100, 0, 0]$. Again, we assume constant infection factors: $[\beta = 0.5, \gamma = 1/6, \epsilon = 1/5, \mu = 731213 / 66436000 / 365]$. $\mu$ is estimated from the UK in 2018, where there were 731,213 live births in a total population of 66,436,000.

```python
# beta and gamma are global variables
def forward_euler_SEIR(S, E, I, R, dt_daily):
    """Evaluate population model using forward euler simulation"""
    beta = beta_0
    for i in range(S.shape[0] - 1):
        # Calculate the derivatives for the current time step i
        dS = -(beta * I[i] * S[i] / N) + (mu * N) - (mu * S[i])
        dE = (beta * I[i] * S[i] / N) - (epsilon * E[i]) - (mu * E[i])
        dI = (epsilon * E[i]) - (gamma * I[i]) - (mu * I[i])
        dR = (gamma * I[i]) - (mu * R[i])

        # Update the population sizes for the next time step i + 1
        S[i + 1] = S[i] + dt_daily * dS
        E[i + 1] = E[i] + dt_daily * dE
        I[i + 1] = I[i] + dt_daily * dI
        R[i + 1] = R[i] + dt_daily * dR
    return S, E, I, R
```

If modeled for 60 days we arrive at the figure below.

{% include figure popup=true image_path="/assets/images/sir/seir_epidemic_progression_forward_euler.gif" alt="SEIR" caption="SEIR Epidemic Trajectory for SARS-CoV-2 using Forward Euler and population data from UK 2018" %}

## SEIRDNC

While the previous models are a useful exercise in compartmental models for epidemiology, they are too simplistic and may fail to capture the nuances of real disease transmission. Most notably, they do not account for a variable value for $\beta$. In the real world, $\beta$ can vary due to governmental invention in the form of stay-at-home orders, mask mandates, and vaccines. To model the transmission of SARS-CoV-2 in Wuhan, we adopt the models in the following paper: https://www.ijidonline.com/article/S1201-9712(20)30117-X/fulltext

$$
\begin{aligned}
\frac{dS}{dt} &= -\frac{\beta_0 S F}{N} - \frac{\beta(t) S I}{N} - \mu S, 
\quad &\text{// Susceptible population} \\\\
\frac{dE}{dt} &= \frac{\beta_0 S F}{N} + \frac{\beta(t) S I}{N} - (\sigma + \mu) E, 
\quad &\text{// Exposed (infected but not yet infectious)} \\\\
\frac{dI}{dt} &= \sigma E - (\gamma + \mu) I, 
\quad &\text{// Infectious individuals} \\\\
\frac{dR}{dt} &= \gamma I - \mu R, 
\quad &\text{// Recovered individuals} \\\\
\frac{dN}{dt} &= -\mu N, 
\quad &\text{// Total population (declines due to death/emigration)} \\\\
\frac{dD}{dt} &= d \gamma I - \lambda D, 
\quad &\text{// Deaths due to infection (with removal rate λ)} \\\\
\frac{dC}{dt} &= \sigma E, 
\quad &\text{// Cumulative confirmed cases}
\end{aligned}
$$

$$
\beta(t) = \beta_0 (1 - \alpha)(1 - \frac{D}{N})^\kappa
$$

where:

- \( \beta_0 \): **Baseline transmission rate** (before intervention or behavioral changes)
- \( \beta(t) \): **Effective transmission rate** at time \( t \), incorporating:
  - \( \alpha \): **Governmental action strength**
    - \( \alpha = 0.4249 \) from Jan 23–29, 2020  
    - \( \alpha = 0.8478 \) after Jan 29, 2020
  - \( \kappa \): **Behavioral response parameter** (sensitivity to deaths)
- \( F(t) \): **Zoonotic force of infection**, modeled as a **step function**:
  - \( F(t) > 0 \) during December 2019  
  - \( F(t) = 0 \) after Huanan seafood market shutdown
- \( \sigma \): **Incubation rate** (rate at which exposed become infectious)
- \( \gamma \): **Recovery rate** (rate at which infectious individuals recover)
- \( \mu \): **Natural death rate**
- \( d \): **Case fatality rate** (fraction of infectious that die)
- \( \lambda \): **Death resolution rate** (e.g., for reporting or removal from active death count)

The implementation for the parameters is below. Due to the more expensive nature of this problem, I solved it using SCIPY's solve_ivp API (method='RK45').

Let us initialize the problem using parameters 
```python
{
  "N": 14000000,          // Total population
  "beta_0": 1.68,         // Baseline transmission rate
  "gamma": 1/5,           // Recovery rate (i.e., ~5 days infectious period)
  "mu": 0.0205 / 100,     // Natural death rate
  "epsilon": 1/3,         // Incubation rate (i.e., ~3 days latent period)
  "F": 0,                 // Zoonotic force of infection (0 after market shutdown)
  "d": 0.2,               // Case fatality rate (CFR)
  "l": 1/11.2,            // Death resolution rate (lambda)
  "alpha": 0.4249,        // Governmental action strength
  "kappa": 1117.3         // Behavioral response parameter
}
```

```python
def beta(D_t, N_t):
    """Returns the value for beta as a function of time"""
    beta = beta_0 * (1 - alpha) * (1 - D_t / N_t)**kappa
    return beta

def seirndc_ode(t, y):
    """Evaluate population model using forward euler simulation"""
    S, E, I, R, N_here, D, C = y

    total = S + E + I + R
    # consistency check
    if not np.isclose(total, N_here):
      print(f"Population inconsistency at t={t}: {total} != {N_here}")

    beta_t = beta(D, N_here)

    dSdt = -(beta_0 * S * F / N_here) - (beta_t * S * I / N_here) - (mu * S)
    dEdt = (beta_0 * S * F / N_here) + (beta_t * S * I / N_here) - (epsilon * E) - (mu * E)
    dIdt = (epsilon * E) - (gamma + mu) * I
    dRdt = (gamma * I) - (mu * R)
    dNdt = -(mu * N_here)
    dDdt = (d * gamma * I) - (l * D)
    dCdt = (epsilon * E)
    return [dSdt, dEdt, dIdt, dRdt, dNdt, dDdt, dCdt]
```

If modeled for 60 days we arrive at the figure below. Here, I omitted the $S$ population for ease of visualization.

{% include figure popup=true image_path="/assets/images/sir/SEIRNDC.png" alt="SEIRNDC" caption="Figure 3: SEIRDNC Epidemic Trajectory SARS-CoV-2 in Wuhan using SCIPY ODE Solver with total (N) and susceptible (S) populations omitted" %}